class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
runApp()
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_qty_based_mtco2e_yr = sum(qty_based_emissions),
qty_based_emission_intensity_mtco2e_ton = sum(qty_based_intensity),
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
colnames(all_products_summarized) <-  c(
"Product",
"Quantity-based Emissions\n(MTCO2e)",
"Quantity-based Emissions Intensity\n(MTCO2e/Ton of Product)",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty,
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr)%>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
View(all_products_summarized)
View(all_products_summarized)
all_products_summarized %>%
select(-c(2:3)) %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
runApp()
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_qty_based_mtco2e_yr = sum(qty_based_emissions),
qty_based_emission_intensity_mtco2e_ton = sum(qty_based_intensity),
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
colnames(all_products_summarized) <-  c(
"Product",
"Quantity-based Emissions\n(MTCO2e)",
"Quantity-based Emissions Intensity\n(MTCO2e/Ton of Product)",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty,
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr)%>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
all_products_summarized %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2,4), digits = 0) %>%
formatRound(columns = c(3,5), digits = 2)
View(all_products_summarized)
View(all_products_breakdown)
View(all_products_breakdown)
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_qty_based_mtco2e_yr = sum(qty_based_emissions),
qty_based_emission_intensity_mtco2e_ton = sum(qty_based_intensity),
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_dollar = sum(revenue_based_intensity_dollar),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
colnames(all_products_summarized) <-  c(
"Product",
"Quantity-based Emissions\n(MTCO2e)",
"Quantity-based Emissions Intensity\n(MTCO2e/Ton of Product)",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/$ of Revenue)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_dollar = revenue_based_intensity_dollar,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr)%>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
all_products_summarized %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2,4), digits = 0) %>%
formatRound(columns = c(3,5), digits = 2)
all_products_summarized %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2,4), digits = 0) %>%
formatRound(columns = c(3,5,6), digits = 2)
runApp()
runApp()
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
View(all_products_summarized)
colnames(all_products_summarized) <-  c(
"Product",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty,
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr) %>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
View(all_products_breakdown)
all_products_summarized %>%
select(-c(2:3)) %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
View(all_products_summarized)
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
abc = "placeholder",
def = "placeholder_2",
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
View(all_products_summarized)
colnames(all_products_summarized) <-  c(
"Product",
"abc",
"def",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty,
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr) %>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
all_products_summarized %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
all_products_summarized %>%
select(-c(2,3)) %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
runApp()
View(all_products_breakdown)
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
abc = "placeholder",
def = "placeholder_2",
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
View(all_products_summarized)
runApp()
runApp()
runApp()
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_qty_based_mtco2e_yr = sum(qty_based_emissions),
qty_based_emission_intensity_mtco2e_ton = sum(qty_based_intensity),
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_dollar = sum(revenue_based_intensity_dollar),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
View(all_products_summarized)
colnames(all_products_summarized) <-  c(
"Product",
"Quantity-based Emissions\n(MTCO2e)",
"Quantity-based Emissions Intensity\n(MTCO2e/Ton of Product)",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/$ Revenue)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_dollar = revenue_based_intensity_dollar,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr)%>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
all_products_summarized %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
runApp()
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
colnames(all_products_summarized) <-  c(
"Product",
"abc",
"def",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty,
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr) %>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
all_products_summarized %>%
select(-c(2,3)) %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
View(all_products_summarized)
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
colnames(all_products_summarized) <-  c(
"Product",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty,
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr) %>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
all_products_summarized %>%
select(-c(2,3)) %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
all_products_summarized  %>%
DT::datatable(
class = 'cell-border stripe hover',
filter = "none",
style = "default",
fillContainer = F,
rownames = F,
selection = "single",
options = list(
columnDefs = list(list(
className = 'dt-center', targets = 0:2
)),
dom = 't',
autoWidth = TRUE
)
) %>%
formatRound(columns = c(2), digits = 0) %>%
formatRound(columns = c(3), digits = 2)
runApp()
runApp()
runApp()
runApp()
all_products_summarized <- all_products_breakdown %>%
group_by(product_number) %>%
summarise(
total_emissions_revenue_based_mtco2e_yr = sum(revenue_based_emissions),
revenue_based_emission_intensity_mtco2e_qty = sum(revenue_based_intensity_qty)
)
colnames(all_products_summarized) <-  c(
"Product",
"Revenue-based Emissions\n(MTCO2e)",
"Revenue-based Emissions Intensity\n(MTCO2e/unit of Product)"
)
download_excel_file <- all_products_breakdown %>%
mutate(qty_weight = qty_based_emissions/co2e_emissions_mt_co2e_yr,
revenue_weight = revenue_based_emissions/co2e_emissions_mt_co2e_yr) %>%
rename(
associated_products = presence,
all_products_co2e_emissions_mt_co2e_yr = co2e_emissions_mt_co2e_yr,
qty_based_emissions_mt_co2e_yr = qty_based_emissions,
qty_based_ei_mt_co2e_per_mt = qty_based_intensity,
revenue_based_emissions_mt_co2e_yr = revenue_based_emissions,
revenue_based_ei_mt_co2e_per_mt_qty = revenue_based_intensity_qty,
) %>%
relocate(qty_based_ei_mt_co2e_per_mt, .after = qty_based_emissions_mt_co2e_yr) %>%
relocate(qty_weight,.after = all_products_co2e_emissions_mt_co2e_yr) %>%
relocate(revenue_weight, .after = qty_based_emissions_mt_co2e_yr)
View(all_products_summarized)
View(all_products_summarized)
runApp()
runApp()
runApp()
shiny::runApp()
